From: Markus Koschany <apo@debian.org>
Date: Wed, 22 May 2019 20:35:25 +0200
Subject: CVE-2019-5436

Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=929351
Origin: https://github.com/curl/curl/commit/2576003415625d7b5f0e390902f8097830b82275
---
 lib/tftp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/tftp.c b/lib/tftp.c
index 99cadde..127d037 100644
--- a/lib/tftp.c
+++ b/lib/tftp.c
@@ -987,7 +987,7 @@ static CURLcode tftp_connect(struct connectdata *conn, bool *done)
   state->sockfd = state->conn->sock[FIRSTSOCKET];
   state->state = TFTP_STATE_START;
   state->error = TFTP_ERR_NONE;
-  state->blksize = TFTP_BLKSIZE_DEFAULT;
+  state->blksize = blksize;
   state->requested_blksize = blksize;
 
   ((struct sockaddr *)&state->local_addr)->sa_family =
