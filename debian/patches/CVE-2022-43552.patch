From 4f20188ac644afe174be6005ef4f6ffba232b8b2 Mon Sep 17 00:00:00 2001
From: Daniel Stenberg <daniel@haxx.se>
Date: Mon, 19 Dec 2022 08:38:37 +0100
Subject: [PATCH] smb/telnet: do not free the protocol struct in *_done()

It is managed by the generic layer.

Reported-by: Trail of Bits

Closes #10112
---
 lib/smb.c    |   19 ++-----------------
 lib/telnet.c |    2 --
 2 files changed, 2 insertions(+), 19 deletions(-)

--- a/lib/telnet.c
+++ b/lib/telnet.c
@@ -1278,8 +1278,6 @@
   curl_slist_free_all(tn->telnet_vars);
   tn->telnet_vars = NULL;
 
-  Curl_safefree(conn->data->req.protop);
-
   return CURLE_OK;
 }
 
