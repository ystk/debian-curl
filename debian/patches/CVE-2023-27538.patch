From: Markus Koschany <apo@debian.org>
Date: Sat, 8 Apr 2023 16:40:20 +0200
Subject: CVE-2023-27538

Origin: https://github.com/curl/curl/commit/af369db4d3833272b8ed443f7fcc2e757a0872eb
---
 lib/url.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/url.c b/lib/url.c
index 580ecc7..6ca24db 100644
--- a/lib/url.c
+++ b/lib/url.c
@@ -3156,8 +3156,8 @@ ConnectionExists(struct SessionHandle *data,
         continue;
 
 
-      if(needle->handler->protocol == CURLPROTO_SCP ||
-         needle->handler->protocol == CURLPROTO_SFTP) {
+      if(needle->handler->protocol & CURLPROTO_SCP ||
+         needle->handler->protocol & CURLPROTO_SFTP) {
 
         if(!ssh_config_matches(needle, check))
           continue;
