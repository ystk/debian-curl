Description: url-parsing: reject CRLFs within URLs
 When libcurl sends a request to a server via a HTTP proxy, 
 it copies the entire URL into the request and sends if off.
 If the given URL contains line feeds and carriage returns 
 those will be sent along to the proxy too, which allows the 
 program to for example send a separate HTTP request injected 
 embedded in the URL.
Author: Daniel Stenberg <daniel@haxx.se>
Origin: upstreams, http://curl.haxx.se/CVE-2014-8150.patch
Bug: http://curl.haxx.se/docs/adv_20150108B.html
Last-Update: 2015-01-10 
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/lib/url.c
+++ b/lib/url.c
@@ -3541,6 +3541,14 @@ static CURLcode parseurlandfillconn(stru
 
   *prot_missing = FALSE;
 
+  /* We might pass the entire URL into the request so we need to make sure
+   * there are no bad characters in there.*/
+  if(strpbrk(data->change.url, "\r\n")) {
+    failf(data, "Illegal characters found in URL");
+    return CURLE_URL_MALFORMAT;
+  }
+
+
   /*************************************************************
    * Parse the URL.
    *
