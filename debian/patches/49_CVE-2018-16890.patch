--- curl-7.38.0.orig/lib/curl_ntlm_msgs.c
+++ curl-7.38.0/lib/curl_ntlm_msgs.c
@@ -199,7 +199,8 @@ CURLcode Curl_ntlm_decode_type2_target(s
     target_info_len = readshort_le(&buffer[40]);
     target_info_offset = readint_le(&buffer[44]);
     if(target_info_len > 0) {
-      if(((target_info_offset + target_info_len) > size) ||
+      if((target_info_offset >= size) ||
+         ((target_info_offset + target_info_len) > size) ||
          (target_info_offset < 48)) {
         infof(data, "NTLM handshake failure (bad type-2 message). "
                     "Target Info Offset Len is set incorrect by the peer\n");
